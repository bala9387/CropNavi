(()=>{var e={};e.id=361,e.ids=[361],e.modules={643:e=>{"use strict";e.exports=require("node:perf_hooks")},1708:e=>{"use strict";e.exports=require("node:process")},3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},4573:e=>{"use strict";e.exports=require("node:buffer")},7252:e=>{"use strict";e.exports=require("express")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},14985:e=>{"use strict";e.exports=require("dns")},16141:e=>{"use strict";e.exports=require("node:zlib")},16698:e=>{"use strict";e.exports=require("node:async_hooks")},18669:(e,t,r)=>{"use strict";r.r(t),r.d(t,{"402e2cc9d57b4307342f6e7077095468f02b3f6783":()=>f,"403f88fc77940a8f73af5d09f071cb709801ed6bcc":()=>s.f,"40660e7df1a476393418de9b0f2a8e91f02c0b69a5":()=>a.L});var a=r(24722),s=r(36580),i=r(91199);r(42087);var n=r(95427),o=r(52205),l=r(68567);let d=l.z.object({photoDataUri:l.z.string().describe("A photo of a plant, as a data URI that must include a MIME type and use Base64 encoding. Expected format: 'data:<mimetype>;base64,<encoded_data>'.")}),c=l.z.object({diseaseName:l.z.string().describe('The common name of the identified disease. If no disease is detected or the plant is healthy, this should be "Healthy".'),confidence:l.z.number().describe("The confidence level of the diagnosis (from 0 to 1). For a healthy plant, this can be high (e.g., 0.95)."),description:l.z.string().describe("A description of the disease, its symptoms, and potential treatments. If healthy, confirm its state.")});var u=r(33331);let p=n.ai.definePrompt({name:"customDiseaseDiagnosisPrompt",input:{schema:d},output:{schema:c},model:o.YF.model("gemini-1.5-pro-preview"),prompt:`You are a specialized agricultural AI model. Your primary function is to identify plant diseases. You have expert-level knowledge for a specific set of 10 crops.

Your expert crops are: **Rice, Wheat, Maize, Tomato, Potato, Cotton, Soybean, Sugarcane, Mango, and Chili**.

Follow these steps precisely:
1.  **Analyze the Image**: Examine the provided photo to identify the plant species first.
2.  **Check if Supported**: After identifying the plant, check if it is one of your 10 expert crops.
3.  **Provide Diagnosis**:
    *   **If the identified plant IS one of your 10 expert crops:**
        *   Analyze the plant for any signs of disease or stress.
        *   If a disease is detected, provide the common name, your confidence level (from 0 to 1), and a brief, actionable description including symptoms and potential treatments.
        *   If the plant appears healthy, set diseaseName to "Healthy", confidence to a high value (e.g., 0.95), and write a description confirming its healthy state.
    *   **If the identified plant is NOT one of your 10 expert crops:**
        *   Set the diseaseName to "Unsupported Crop".
        *   Set the confidence to 0.
        *   Set the description to: "I am a specialized model trained only on Rice, Wheat, Maize, Tomato, Potato, Cotton, Soybean, Sugarcane, Mango, and Chili. I cannot provide a diagnosis for this plant."
    *   **If the image is not a plant:**
         *   Set the diseaseName to "Not a Plant".
         *   Set the confidence to 0.
         *   Set the description to: "The uploaded image does not appear to contain a plant. Please upload a clear photo of a plant leaf for analysis."


Analyze the following image.

Photo: {{media url=photoDataUri}}
`}),m=n.ai.defineFlow({name:"aiDiseaseDetectionFlow",inputSchema:d,outputSchema:c},async e=>{for(let t=0;t<3;t++)try{let{output:t}=await p(e);if(t)return t;throw Error("The AI model did not return a valid output for diagnosis.")}catch(e){if(console.error(`Error during disease detection (Attempt ${t+1}/3):`,e),2===t)return{diseaseName:"Brown Spot (Dummy Data)",confidence:.85,description:"This is sample data. Brown Spot is a fungal disease affecting rice. Symptoms include small, circular, dark brown lesions on leaves and glumes.\n\nTreatment: Apply a recommended fungicide like Propiconazole or Mancozeb. Ensure proper water management and balanced fertilization to reduce plant stress."};await new Promise(e=>setTimeout(e,500))}return{diseaseName:"Analysis Failed",confidence:0,description:"An unexpected error occurred after multiple retries."}});async function f(e){return await m(e)}(0,u.D)([f]),(0,i.A)(f,"402e2cc9d57b4307342f6e7077095468f02b3f6783",null)},19063:e=>{"use strict";e.exports=require("require-in-the-middle")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19185:e=>{"use strict";e.exports=require("dgram")},19771:e=>{"use strict";e.exports=require("process")},21820:e=>{"use strict";e.exports=require("os")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},29844:(e,t,r)=>{"use strict";r.d(t,{tU:()=>R,av:()=>z,j7:()=>I,Xi:()=>P});var a=r(60687),s=r(43210),i=r(70569),n=r(11273),o=r(72942),l=r(46059),d=r(3416),c=r(43),u=r(65551),p=r(96963),m="Tabs",[f,x]=(0,n.A)(m,[o.RG]),h=(0,o.RG)(),[v,g]=f(m),y=s.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,onValueChange:i,defaultValue:n,orientation:o="horizontal",dir:l,activationMode:m="automatic",...f}=e,x=(0,c.jH)(l),[h,g]=(0,u.i)({prop:s,onChange:i,defaultProp:n});return(0,a.jsx)(v,{scope:r,baseId:(0,p.B)(),value:h,onValueChange:g,orientation:o,dir:x,activationMode:m,children:(0,a.jsx)(d.sG.div,{dir:x,"data-orientation":o,...f,ref:t})})});y.displayName=m;var j="TabsList",b=s.forwardRef((e,t)=>{let{__scopeTabs:r,loop:s=!0,...i}=e,n=g(j,r),l=h(r);return(0,a.jsx)(o.bL,{asChild:!0,...l,orientation:n.orientation,dir:n.dir,loop:s,children:(0,a.jsx)(d.sG.div,{role:"tablist","aria-orientation":n.orientation,...i,ref:t})})});b.displayName=j;var N="TabsTrigger",w=s.forwardRef((e,t)=>{let{__scopeTabs:r,value:s,disabled:n=!1,...l}=e,c=g(N,r),u=h(r),p=A(c.baseId,s),m=k(c.baseId,s),f=s===c.value;return(0,a.jsx)(o.q7,{asChild:!0,...u,focusable:!n,active:f,children:(0,a.jsx)(d.sG.button,{type:"button",role:"tab","aria-selected":f,"aria-controls":m,"data-state":f?"active":"inactive","data-disabled":n?"":void 0,disabled:n,id:p,...l,ref:t,onMouseDown:(0,i.m)(e.onMouseDown,e=>{n||0!==e.button||!1!==e.ctrlKey?e.preventDefault():c.onValueChange(s)}),onKeyDown:(0,i.m)(e.onKeyDown,e=>{[" ","Enter"].includes(e.key)&&c.onValueChange(s)}),onFocus:(0,i.m)(e.onFocus,()=>{let e="manual"!==c.activationMode;f||n||!e||c.onValueChange(s)})})})});w.displayName=N;var q="TabsContent",C=s.forwardRef((e,t)=>{let{__scopeTabs:r,value:i,forceMount:n,children:o,...c}=e,u=g(q,r),p=A(u.baseId,i),m=k(u.baseId,i),f=i===u.value,x=s.useRef(f);return s.useEffect(()=>{let e=requestAnimationFrame(()=>x.current=!1);return()=>cancelAnimationFrame(e)},[]),(0,a.jsx)(l.C,{present:n||f,children:({present:r})=>(0,a.jsx)(d.sG.div,{"data-state":f?"active":"inactive","data-orientation":u.orientation,role:"tabpanel","aria-labelledby":p,hidden:!r,id:m,tabIndex:0,...c,ref:t,style:{...e.style,animationDuration:x.current?"0s":void 0},children:r&&o})})});function A(e,t){return`${e}-trigger-${t}`}function k(e,t){return`${e}-content-${t}`}C.displayName=q;var D=r(4780);let R=y,I=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(b,{ref:r,className:(0,D.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",e),...t}));I.displayName=b.displayName;let P=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(w,{ref:r,className:(0,D.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",e),...t}));P.displayName=w.displayName;let z=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(C,{ref:r,className:(0,D.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...t}));z.displayName=C.displayName},33873:e=>{"use strict";e.exports=require("path")},34631:e=>{"use strict";e.exports=require("tls")},37067:e=>{"use strict";e.exports=require("node:http")},37830:e=>{"use strict";e.exports=require("node:stream/web")},39399:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>p,tree:()=>d});var a=r(65239),s=r(48088),i=r(88170),n=r.n(i),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d={children:["",{children:["disease-detection",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,91935)),"C:\\Users\\balac\\OneDrive\\Desktop\\Crop Navi\\src\\app\\disease-detection\\page.tsx"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,94431)),"C:\\Users\\balac\\OneDrive\\Desktop\\Crop Navi\\src\\app\\layout.tsx"],loading:[()=>Promise.resolve().then(r.bind(r,67393)),"C:\\Users\\balac\\OneDrive\\Desktop\\Crop Navi\\src\\app\\loading.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,70440))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,c=["C:\\Users\\balac\\OneDrive\\Desktop\\Crop Navi\\src\\app\\disease-detection\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/disease-detection/page",pathname:"/disease-detection",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},44708:e=>{"use strict";e.exports=require("node:https")},45033:(e,t,r)=>{Promise.resolve().then(r.bind(r,98086))},46657:(e,t,r)=>{"use strict";r.d(t,{k:()=>b});var a=r(60687),s=r(43210),i=r(11273),n=r(3416),o="Progress",[l,d]=(0,i.A)(o),[c,u]=l(o),p=s.forwardRef((e,t)=>{var r,s;let{__scopeProgress:i,value:o=null,max:l,getValueLabel:d=x,...u}=e;(l||0===l)&&!g(l)&&console.error((r=`${l}`,`Invalid prop \`max\` of value \`${r}\` supplied to \`Progress\`. Only numbers greater than 0 are valid max values. Defaulting to \`100\`.`));let p=g(l)?l:100;null===o||y(o,p)||console.error((s=`${o}`,`Invalid prop \`value\` of value \`${s}\` supplied to \`Progress\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or 100 if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`));let m=y(o,p)?o:null,f=v(m)?d(m,p):void 0;return(0,a.jsx)(c,{scope:i,value:m,max:p,children:(0,a.jsx)(n.sG.div,{"aria-valuemax":p,"aria-valuemin":0,"aria-valuenow":v(m)?m:void 0,"aria-valuetext":f,role:"progressbar","data-state":h(m,p),"data-value":m??void 0,"data-max":p,...u,ref:t})})});p.displayName=o;var m="ProgressIndicator",f=s.forwardRef((e,t)=>{let{__scopeProgress:r,...s}=e,i=u(m,r);return(0,a.jsx)(n.sG.div,{"data-state":h(i.value,i.max),"data-value":i.value??void 0,"data-max":i.max,...s,ref:t})});function x(e,t){return`${Math.round(e/t*100)}%`}function h(e,t){return null==e?"indeterminate":e===t?"complete":"loading"}function v(e){return"number"==typeof e}function g(e){return v(e)&&!isNaN(e)&&e>0}function y(e,t){return v(e)&&!isNaN(e)&&e<=t&&e>=0}f.displayName=m;var j=r(4780);let b=s.forwardRef(({className:e,value:t,...r},s)=>(0,a.jsx)(p,{ref:s,className:(0,j.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...r,children:(0,a.jsx)(f,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));b.displayName=p.displayName},54379:e=>{"use strict";e.exports=require("node:path")},54761:(e,t,r)=>{Promise.resolve().then(r.bind(r,91935))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},56801:e=>{"use strict";e.exports=require("import-in-the-middle")},57075:e=>{"use strict";e.exports=require("node:stream")},57975:e=>{"use strict";e.exports=require("node:util")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},70440:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});var a=r(31658);let s=async e=>[{type:"image/x-icon",sizes:"16x16",url:(0,a.fillMetadataSegment)(".",await e.params,"favicon.ico")+""}]},71669:(e,t,r)=>{"use strict";r.d(t,{C5:()=>g,MJ:()=>h,Rr:()=>v,eI:()=>f,lR:()=>x,lV:()=>d,zB:()=>u});var a=r(60687),s=r(43210),i=r(11329),n=r(27605),o=r(4780),l=r(80013);let d=n.Op,c=s.createContext({}),u=({...e})=>(0,a.jsx)(c.Provider,{value:{name:e.name},children:(0,a.jsx)(n.xI,{...e})}),p=()=>{let e=s.useContext(c),t=s.useContext(m),{getFieldState:r,formState:a}=(0,n.xW)(),i=r(e.name,a);if(!e)throw Error("useFormField should be used within <FormField>");let{id:o}=t;return{id:o,name:e.name,formItemId:`${o}-form-item`,formDescriptionId:`${o}-form-item-description`,formMessageId:`${o}-form-item-message`,...i}},m=s.createContext({}),f=s.forwardRef(({className:e,...t},r)=>{let i=s.useId();return(0,a.jsx)(m.Provider,{value:{id:i},children:(0,a.jsx)("div",{ref:r,className:(0,o.cn)("space-y-2",e),...t})})});f.displayName="FormItem";let x=s.forwardRef(({className:e,...t},r)=>{let{error:s,formItemId:i}=p();return(0,a.jsx)(l.J,{ref:r,className:(0,o.cn)(s&&"text-destructive",e),htmlFor:i,...t})});x.displayName="FormLabel";let h=s.forwardRef(({...e},t)=>{let{error:r,formItemId:s,formDescriptionId:n,formMessageId:o}=p();return(0,a.jsx)(i.DX,{ref:t,id:s,"aria-describedby":r?`${n} ${o}`:`${n}`,"aria-invalid":!!r,...e})});h.displayName="FormControl";let v=s.forwardRef(({className:e,...t},r)=>{let{formDescriptionId:s}=p();return(0,a.jsx)("p",{ref:r,id:s,className:(0,o.cn)("text-sm text-muted-foreground",e),...t})});v.displayName="FormDescription";let g=s.forwardRef(({className:e,children:t,...r},s)=>{let{error:i,formMessageId:n}=p(),l=i?String(i?.message??""):t;return l?(0,a.jsx)("p",{ref:s,id:n,className:(0,o.cn)("text-sm font-medium text-destructive",e),...r,children:l}):null});g.displayName="FormMessage"},73024:e=>{"use strict";e.exports=require("node:fs")},73136:e=>{"use strict";e.exports=require("node:url")},73496:e=>{"use strict";e.exports=require("http2")},73566:e=>{"use strict";e.exports=require("worker_threads")},74075:e=>{"use strict";e.exports=require("zlib")},74998:e=>{"use strict";e.exports=require("perf_hooks")},77030:e=>{"use strict";e.exports=require("node:net")},77598:e=>{"use strict";e.exports=require("node:crypto")},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")},79646:e=>{"use strict";e.exports=require("child_process")},79748:e=>{"use strict";e.exports=require("fs/promises")},80013:(e,t,r)=>{"use strict";r.d(t,{J:()=>d});var a=r(60687),s=r(43210),i=r(78148),n=r(24224),o=r(4780);let l=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)(i.b,{ref:r,className:(0,o.cn)(l(),e),...t}));d.displayName=i.b.displayName},81630:e=>{"use strict";e.exports=require("http")},84297:e=>{"use strict";e.exports=require("async_hooks")},91645:e=>{"use strict";e.exports=require("net")},91935:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"C:\\\\Users\\\\balac\\\\OneDrive\\\\Desktop\\\\Crop Navi\\\\src\\\\app\\\\disease-detection\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"C:\\Users\\balac\\OneDrive\\Desktop\\Crop Navi\\src\\app\\disease-detection\\page.tsx","default")},94735:e=>{"use strict";e.exports=require("events")},98086:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>T});var a=r(60687),s=r(43210),i=r(27605),n=r(45880),o=r(6475);let l=(0,o.createServerReference)("402e2cc9d57b4307342f6e7077095468f02b3f6783",o.callServer,void 0,o.findSourceMapURL,"aiDiseaseDetection");var d=r(63442),c=r(29523),u=r(44493),p=r(89667),m=r(71669),f=r(29867),x=r(21068),h=r(82614);let v=(0,h.A)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]),g=(0,h.A)("File",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]]),y=(0,h.A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);var j=r(11516);let b=(0,h.A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]),N=(0,h.A)("Upload",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]]);var w=r(30474),q=r(46657),C=r(29844),A=r(24224),k=r(4780);let D=(0,A.F)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),R=s.forwardRef(({className:e,variant:t,...r},s)=>(0,a.jsx)("div",{ref:s,role:"alert",className:(0,k.cn)(D({variant:t}),e),...r}));R.displayName="Alert";let I=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("h5",{ref:r,className:(0,k.cn)("mb-1 font-medium leading-none tracking-tight",e),...t}));I.displayName="AlertTitle";let P=s.forwardRef(({className:e,...t},r)=>(0,a.jsx)("div",{ref:r,className:(0,k.cn)("text-sm [&_p]:leading-relaxed",e),...t}));P.displayName="AlertDescription";var z=r(37123);let M=["image/jpeg","image/jpg","image/png","image/webp"],F=n.z.object({plantImage:n.z.custom().refine(e=>e?.length===1,"Image is required.").refine(e=>e?.[0]?.size<=5242880,"Max file size is 5MB.").refine(e=>M.includes(e?.[0]?.type),".jpg, .jpeg, .png and .webp files are accepted.")}),S={title:"AI Disease Detection",description:"Use your camera or upload a photo of an affected plant leaf to get an AI-powered diagnosis.",liveCamera:"Live Camera",uploadFile:"Upload File",cameraAccessRequired:"Camera Access Required",cameraAccessMessage:"Please allow camera access in your browser settings to use this feature.",captureAndDiagnose:"Capture & Diagnose",plantPhoto:"Plant Photo",uploadDescription:"Upload a clear image of the affected plant part. Max 5MB.",diagnose:"Diagnose",imageToAnalyze:"Image to Analyze",scanning:"Scanning for diseases...",diagnosisResult:"Diagnosis Result",confidence:"Confidence",descriptionAndTreatment:"Description & Treatment",looksHealthy:"Looks Healthy!",noDisease:"No significant disease was detected in the image.",placeholder:"Use your camera or upload an image and your diagnosis will appear here."};function T(){let[e,t]=(0,s.useState)(null),[r,n]=(0,s.useState)(!1),[o,h]=(0,s.useState)(null),{toast:A}=(0,f.dj)(),[k,D]=(0,s.useState)(null),T=(0,s.useRef)(null),[_,K]=(0,s.useState)("camera"),{translatedText:U,T:$,isTranslating:E}=(0,z.Bd)(S),B=(0,i.mN)({resolver:(0,d.u)(F)}),G=e=>{let t=e.target.files?.[0];if(t){let e=new FileReader;e.onloadend=()=>{h(e.result)},e.readAsDataURL(t)}else h(null)},L=e=>new Promise((t,r)=>{let a=new FileReader;a.readAsDataURL(e),a.onload=()=>t(a.result),a.onerror=e=>r(e)}),V=()=>{if(T.current){let e=document.createElement("canvas");e.width=T.current.videoWidth,e.height=T.current.videoHeight;let t=e.getContext("2d");if(t)return t.drawImage(T.current,0,0,e.width,e.height),e.toDataURL("image/jpeg")}return null};async function H(e){n(!0),t(null);try{let r=await l({photoDataUri:e});t(r)}catch(e){console.error("Error detecting disease:",e),A({title:"Error",description:"Failed to analyze the image. Please try again.",variant:"destructive"})}finally{n(!1)}}async function O(e){if(e.plantImage){let t=e.plantImage[0],r=await L(t);h(r),await H(r)}}async function W(){let e=V();e?(h(e),await H(e)):A({title:"Error",description:"Could not capture image from camera.",variant:"destructive"})}return(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[(0,a.jsxs)(u.Zp,{children:[(0,a.jsxs)(u.aR,{children:[(0,a.jsxs)(u.ZB,{className:"font-headline flex items-center gap-2",children:[(0,a.jsx)(x.A,{className:"text-primary"}),(0,a.jsx)($,{textKey:"title"})]}),(0,a.jsx)(u.BT,{children:(0,a.jsx)($,{textKey:"description"})})]}),(0,a.jsx)(u.Wu,{children:(0,a.jsxs)(C.tU,{value:_,onValueChange:K,className:"w-full",children:[(0,a.jsxs)(C.j7,{className:"grid w-full grid-cols-2",children:[(0,a.jsxs)(C.Xi,{value:"camera",disabled:E,children:[(0,a.jsx)(v,{className:"mr-2"}),(0,a.jsx)($,{textKey:"liveCamera"})]}),(0,a.jsxs)(C.Xi,{value:"upload",disabled:E,children:[(0,a.jsx)(g,{className:"mr-2"}),(0,a.jsx)($,{textKey:"uploadFile"})]})]}),(0,a.jsx)(C.av,{value:"camera",className:"mt-6",children:(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("div",{className:"w-full aspect-video relative rounded-md overflow-hidden border bg-muted",children:(0,a.jsx)("video",{ref:T,className:"w-full aspect-video rounded-md",autoPlay:!0,muted:!0,playsInline:!0})}),!1===k&&(0,a.jsxs)(R,{variant:"destructive",children:[(0,a.jsx)(y,{className:"h-4 w-4"}),(0,a.jsx)(I,{children:(0,a.jsx)($,{textKey:"cameraAccessRequired"})}),(0,a.jsx)(P,{children:(0,a.jsx)($,{textKey:"cameraAccessMessage"})})]}),(0,a.jsxs)(c.$,{onClick:W,disabled:r||!k||E,className:"w-full",children:[r?(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(v,{className:"mr-2 h-4 w-4"}),(0,a.jsx)($,{textKey:"captureAndDiagnose"})]})]})}),(0,a.jsx)(C.av,{value:"upload",className:"mt-6",children:(0,a.jsx)(m.lV,{...B,children:(0,a.jsxs)("form",{onSubmit:B.handleSubmit(O),className:"space-y-6",children:[(0,a.jsx)(m.zB,{control:B.control,name:"plantImage",render:({field:{onChange:e,value:t,...r}})=>(0,a.jsxs)(m.eI,{children:[(0,a.jsx)(m.lR,{children:(0,a.jsx)($,{textKey:"plantPhoto"})}),(0,a.jsx)(m.MJ,{children:(0,a.jsx)("div",{className:"relative",children:(0,a.jsx)(p.p,{type:"file",accept:M.join(","),onChange:t=>{e(t.target.files),G(t)},className:"pt-2",...r})})}),(0,a.jsx)(m.Rr,{children:(0,a.jsx)($,{textKey:"uploadDescription"})}),(0,a.jsx)(m.C5,{})]})}),o&&"upload"===_&&(0,a.jsx)("div",{className:"w-full aspect-video relative rounded-md overflow-hidden border",children:(0,a.jsx)(w.default,{src:o,alt:"Image preview",fill:!0,className:"object-cover"})}),(0,a.jsxs)(c.$,{type:"submit",disabled:r||!B.formState.isValid||E,className:"w-full",children:[r?(0,a.jsx)(j.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,a.jsx)(x.A,{className:"mr-2 h-4 w-4"}),(0,a.jsx)($,{textKey:"diagnose"})]})]})})})]})})]}),(0,a.jsxs)("div",{className:"lg:sticky top-6 space-y-4",children:[o&&(0,a.jsxs)(u.Zp,{children:[(0,a.jsx)(u.aR,{children:(0,a.jsx)(u.ZB,{className:"font-headline",children:(0,a.jsx)($,{textKey:"imageToAnalyze"})})}),(0,a.jsx)(u.Wu,{children:(0,a.jsx)("div",{className:"w-full aspect-video relative rounded-md overflow-hidden border",children:(0,a.jsx)(w.default,{src:o,alt:"Image preview",fill:!0,className:"object-cover"})})})]}),r&&(0,a.jsx)(u.Zp,{children:(0,a.jsxs)(u.Wu,{className:"p-6 flex flex-col items-center justify-center min-h-[300px]",children:[(0,a.jsx)(j.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,a.jsx)("p",{className:"mt-4 text-muted-foreground",children:(0,a.jsx)($,{textKey:"scanning"})})]})}),e&&(0,a.jsxs)(u.Zp,{className:"animate-in fade-in-50",children:[(0,a.jsx)(u.aR,{children:(0,a.jsx)(u.ZB,{className:"font-headline",children:(0,a.jsx)($,{textKey:"diagnosisResult"})})}),(0,a.jsx)(u.Wu,{className:"space-y-4",children:"healthy"!==e.diseaseName.toLowerCase()?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(y,{className:"size-6 text-destructive"}),(0,a.jsx)("h3",{className:"font-semibold text-lg font-headline",children:e.diseaseName})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium",children:(0,a.jsx)($,{textKey:"confidence"})}),(0,a.jsx)(q.k,{value:100*e.confidence,className:"h-2 mt-1"}),(0,a.jsxs)("p",{className:"text-xs text-muted-foreground text-right mt-1",children:[(100*e.confidence).toFixed(0),"% confident"]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("h4",{className:"font-semibold",children:(0,a.jsx)($,{textKey:"descriptionAndTreatment"})}),(0,a.jsx)("p",{className:"text-muted-foreground whitespace-pre-wrap",children:e.description})]})]}):(0,a.jsxs)("div",{className:"text-center py-8",children:[(0,a.jsx)(b,{className:"size-12 text-primary mx-auto"}),(0,a.jsx)("h3",{className:"font-semibold text-lg font-headline mt-4",children:(0,a.jsx)($,{textKey:"looksHealthy"})}),(0,a.jsx)("p",{className:"text-muted-foreground mt-2",children:e.description})]})})]}),!r&&!e&&(0,a.jsx)(u.Zp,{className:"border-dashed",children:(0,a.jsxs)(u.Wu,{className:"p-6 flex flex-col items-center justify-center min-h-[300px] text-center",children:[(0,a.jsx)(N,{className:"h-12 w-12 text-muted-foreground/50"}),(0,a.jsx)("p",{className:"mt-4 text-muted-foreground",children:(0,a.jsx)($,{textKey:"placeholder"})})]})})]})]})}}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[447,113,658,758,474,765],()=>r(39399));module.exports=a})();