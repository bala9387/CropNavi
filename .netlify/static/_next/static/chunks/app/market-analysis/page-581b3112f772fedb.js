(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[116],{7090:(a,e,r)=>{Promise.resolve().then(r.bind(r,63660))},17759:(a,e,r)=>{"use strict";r.d(e,{C5:()=>j,MJ:()=>x,Rr:()=>y,eI:()=>p,lR:()=>g,lV:()=>o,zB:()=>u});var t=r(95155),i=r(12115),n=r(66634),s=r(62177),l=r(59434),d=r(85057);let o=s.Op,h=i.createContext({}),u=a=>{let{...e}=a;return(0,t.jsx)(h.Provider,{value:{name:e.name},children:(0,t.jsx)(s.xI,{...e})})},m=()=>{let a=i.useContext(h),e=i.useContext(c),{getFieldState:r,formState:t}=(0,s.xW)(),n=r(a.name,t);if(!a)throw Error("useFormField should be used within <FormField>");let{id:l}=e;return{id:l,name:a.name,formItemId:"".concat(l,"-form-item"),formDescriptionId:"".concat(l,"-form-item-description"),formMessageId:"".concat(l,"-form-item-message"),...n}},c=i.createContext({}),p=i.forwardRef((a,e)=>{let{className:r,...n}=a,s=i.useId();return(0,t.jsx)(c.Provider,{value:{id:s},children:(0,t.jsx)("div",{ref:e,className:(0,l.cn)("space-y-2",r),...n})})});p.displayName="FormItem";let g=i.forwardRef((a,e)=>{let{className:r,...i}=a,{error:n,formItemId:s}=m();return(0,t.jsx)(d.J,{ref:e,className:(0,l.cn)(n&&"text-destructive",r),htmlFor:s,...i})});g.displayName="FormLabel";let x=i.forwardRef((a,e)=>{let{...r}=a,{error:i,formItemId:s,formDescriptionId:l,formMessageId:d}=m();return(0,t.jsx)(n.DX,{ref:e,id:s,"aria-describedby":i?"".concat(l," ").concat(d):"".concat(l),"aria-invalid":!!i,...r})});x.displayName="FormControl";let y=i.forwardRef((a,e)=>{let{className:r,...i}=a,{formDescriptionId:n}=m();return(0,t.jsx)("p",{ref:e,id:n,className:(0,l.cn)("text-sm text-muted-foreground",r),...i})});y.displayName="FormDescription";let j=i.forwardRef((a,e)=>{var r;let{className:i,children:n,...s}=a,{error:d,formMessageId:o}=m(),h=d?String(null!=(r=null==d?void 0:d.message)?r:""):n;return h?(0,t.jsx)("p",{ref:e,id:o,className:(0,l.cn)("text-sm font-medium text-destructive",i),...s,children:h}):null});j.displayName="FormMessage"},63660:(a,e,r)=>{"use strict";r.r(e),r.d(e,{default:()=>I,dynamic:()=>H});var t=r(95155),i=r(12115),n=r(62177),s=r(90221),l=r(55594),d=r(34477);let o=(0,d.createServerReference)("40cbf51d02760c9449d536f6fed3b955a5b8b420ef",d.callServer,void 0,d.findSourceMapURL,"summarizeMarketData");var h=r(83013),u=r(51920),m=r(59434),c=r(30285),p=r(965),g=r(73158),x=r(37466);function y(a){let{className:e,classNames:r,showOutsideDays:i=!0,...n}=a;return(0,t.jsx)(x.hv,{showOutsideDays:i,className:(0,m.cn)("p-3",e),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:(0,m.cn)((0,c.r)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,m.cn)((0,c.r)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...r},components:{IconLeft:a=>{let{className:e,...r}=a;return(0,t.jsx)(p.A,{className:(0,m.cn)("h-4 w-4",e),...r})},IconRight:a=>{let{className:e,...r}=a;return(0,t.jsx)(g.A,{className:(0,m.cn)("h-4 w-4",e),...r})}},...n})}y.displayName="Calendar";var j=r(17759),f=r(98176);let b=f.bL,S=f.l9,k=i.forwardRef((a,e)=>{let{className:r,align:i="center",sideOffset:n=4,...s}=a;return(0,t.jsx)(f.ZL,{children:(0,t.jsx)(f.UC,{ref:e,align:i,sideOffset:n,className:(0,m.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",r),...s})})});k.displayName=f.UC.displayName;var N=r(59409),w=r(62523),K=r(88539),v=r(66695),D=r(50172),M=r(25299),B=r(15300),P=r(58527),C=r(87481),A=r(83540),R=r(93774),T=r(96025),G=r(16238),J=r(94517),L=r(17398),z=r(27696);let H="force-dynamic",E=l.z.object({marketData:l.z.string().min(20,{message:"Please provide more market data."}).optional().or(l.z.literal("")),farmerExpenditures:l.z.string().min(3,{message:"Please enter your expenditures."})}),F=["Wheat","Paddy","Maize","Mustard","Arhar (Tur)","Bajra","Barley","Black Pepper","Cardamom","Cashew Nuts","Castor Seed","Coconut","Coffee","Coriander","Cotton","Finger Millet (Ragi)","Gram (Chana)","Groundnut","Guar Seed","Horse-gram","Jowar (Sorghum)","Jute","Korra","Lentil (Masur)","Linseed","Mahua","Masur","Moong (Green Gram)","Niger Seed","Onion","Other Pulses","Potato","Ragi","Rapeseed & Mustard","Rice","Rubber","Safflower","Sannhamp","Sesamum","Soyabean","Sugarcane","Sunflower","Tamarind","Tea","Tobacco","Turmeric","Urad","Varagu"],W=["Andaman and Nicobar Islands","Andhra Pradesh","Arunachal Pradesh","Assam","Bihar","Chandigarh","Chhattisgarh","Dadra and Nagar Haveli and Daman and Diu","Delhi","Goa","Gujarat","Haryana","Himachal Pradesh","Jammu and Kashmir","Jharkhand","Karnataka","Kerala","Ladakh","Lakshadweep","Madhya Pradesh","Maharashtra","Manipur","Meghalaya","Mizoram","Nagaland","Odisha","Puducherry","Punjab","Rajasthan","Sikkim","Tamil Nadu","Telangana","Tripura","Uttar Pradesh","Uttarakhand","West Bengal"],U={"Andaman and Nicobar Islands":["Nicobar","North and Middle Andaman","South Andaman"],"Andhra Pradesh":["Alluri Sitharama Raju","Anakapalli","Ananthapuramu","Annamayya","Bapatla","Chittoor","Dr. B.R. Ambedkar Konaseema","East Godavari","Eluru","Guntur","Kakinada","Krishna","Kurnool","Nandyal","NTR","Palnadu","Parvathipuram Manyam","Prakasam","Srikakulam","Sri Potti Sriramulu Nellore","Sri Sathya Sai","Tirupati","Visakhapatnam","Vizianagaram","West Godavari","YSR"],"Arunachal Pradesh":["Anjaw","Changlang","Dibang Valley","East Kameng","East Siang","Kamle","Kra Daadi","Kurung Kumey","Lepa Rada","Lohit","Longding","Lower Dibang Valley","Lower Siang","Lower Subansiri","Namsai","Pakke Kessang","Papum Pare","Shi Yomi","Siang","Tawang","Tirap","Upper Siang","Upper Subansiri","West Kameng","West Siang"],Assam:["Bajali","Baksa","Barpeta","Biswanath","Bongaigaon","Cachar","Charaideo","Chirang","Darrang","Dhemaji","Dhubri","Dibrugarh","Dima Hasao","Goalpara","Golaghat","Hailakandi","Hojai","Jorhat","Kamrup","Kamrup Metropolitan","Karbi Anglong","Karimganj","Kokrajhar","Lakhimpur","Majuli","Morigaon","Nagaon","Nalbari","Sivasagar","Sonitpur","South Salmara-Mankachar","Tamulpur","Tinsukia","Udalguri","West Karbi Anglong"],Bihar:["Araria","Arwal","Aurangabad","Banka","Begusarai","Bhagalpur","Bhojpur","Buxar","Darbhanga","East Champaran","Gaya","Gopalganj","Jamui","Jehanabad","Kaimur","Katihar","Khagaria","Kishanganj","Lakhisarai","Madhepura","Madhubani","Munger","Muzaffarpur","Nalanda","Nawada","Patna","Purnia","Rohtas","Saharsa","Samastipur","Saran","Sheikhpura","Sheohar","Sitamarhi","Siwan","Supaul","Vaishali","West Champaran"],Chandigarh:["Chandigarh"],Chhattisgarh:["Balod","Baloda Bazar","Balrampur","Bastar","Bemetara","Bijapur","Bilaspur","Dantewada","Dhamtari","Durg","Gariaband","Gaurela Pendra Marwahi","Janjgir-Champa","Jashpur","Kabirdham","Kanker","Khairagarh-Chhuikhadan-Gandai","Kondagaon","Korba","Koriya","Mahasamund","Manendragarh-Chirmiri-Bharatpur","Mohla-Manpur-Ambagarh Chowki","Mungeli","Narayanpur","Raigarh","Raipur","Rajnandgaon","Sakti","Sarangarh-Bilaigarh","Sukma","Surajpur","Surguja"],"Dadra and Nagar Haveli and Daman and Diu":["Daman","Diu","Dadra and Nagar Haveli"],Delhi:["Central Delhi","East Delhi","New Delhi","North Delhi","North East Delhi","North West Delhi","Shahdara","South Delhi","South East Delhi","South West Delhi","West Delhi"],Goa:["North Goa","South Goa"],Gujarat:["Ahmedabad","Amreli","Anand","Aravalli","Banaskantha","Bharuch","Bhavnagar","Botad","Chhota Udaipur","Dahod","Dang","Devbhoomi Dwarka","Gandhinagar","Gir Somnath","Jamnagar","Junagadh","Kheda","Kutch","Mahisagar","Mehsana","Morbi","Narmada","Navsari","Panchmahal","Patan","Porbandar","Rajkot","Sabarkantha","Surat","Surendranagar","Tapi","Vadodara","Valsad"],Haryana:["Ambala","Bhiwani","Charkhi Dadri","Faridabad","Fatehabad","Gurugram","Hisar","Jhajjar","Jind","Kaithal","Karnal","Kurukshetra","Mahendragarh","Nuh","Palwal","Panchkula","Panipat","Rewari","Rohtak","Sirsa","Sonipat","Yamunanagar"],"Himachal Pradesh":["Bilaspur","Chamba","Hamirpur","Kangra","Kinnaur","Kullu","Lahaul and Spiti","Mandi","Shimla","Sirmaur","Solan","Una"],"Jammu and Kashmir":["Anantnag","Bandipora","Baramulla","Budgam","Doda","Ganderbal","Jammu","Kathua","Kishtwar","Kulgam","Kupwara","Poonch","Pulwama","Rajouri","Ramban","Reasi","Samba","Shopian","Srinagar","Udhampur"],Jharkhand:["Bokaro","Chatra","Deoghar","Dhanbad","Dumka","East Singhbhum","Garhwa","Giridih","Godda","Gumla","Hazaribagh","Jamtara","Khunti","Koderma","Latehar","Lohardaga","Pakur","Palamu","Ramgarh","Ranchi","Sahebganj","Seraikela Kharsawan","Simdega","West Singhbhum"],Karnataka:["Bagalkot","Ballari","Belagavi","Bengaluru Rural","Bengaluru Urban","Bidar","Chamarajanagar","Chikkaballapur","Chikkamagaluru","Chitradurga","Dakshina Kannada","Davanagere","Dharwad","Gadag","Hassan","Haveri","Kalaburagi","Kodagu","Kolar","Koppal","Mandya","Mysuru","Raichur","Ramanagara","Shivamogga","Tumakuru","Udupi","Uttara Kannada","Vijayanagara","Vijayapura","Yadgir"],Kerala:["Alappuzha","Ernakulam","Idukki","Kannur","Kasaragod","Kollam","Kottayam","Kozhikode","Malappuram","Palakkad","Pathanamthitta","Thiruvananthapuram","Thrissur","Wayanad"],Ladakh:["Kargil","Leh"],Lakshadweep:["Lakshadweep"],"Madhya Pradesh":["Agar Malwa","Alirajpur","Anuppur","Ashoknagar","Balaghat","Barwani","Betul","Bhind","Bhopal","Burhanpur","Chhatarpur","Chhindwara","Damoh","Datia","Dewas","Dhar","Dindori","Guna","Gwalior","Harda","Indore","Jabalpur","Jhabua","Katni","Khandwa","Khargone","Mandla","Mandsaur","Morena","Narmadapuram","Narsinghpur","Neemuch","Niwari","Panna","Raisen","Rajgarh","Ratlam","Rewa","Sagar","Satna","Sehore","Seoni","Shahdol","Shajapur","Sheopur","Shivpuri","Sidhi","Singrauli","Tikamgarh","Ujjain","Umaria","Vidisha"],Maharashtra:["Ahmednagar","Akola","Amravati","Aurangabad","Beed","Bhandara","Buldhana","Chandrapur","Dhule","Gadchiroli","Gondia","Hingoli","Jalgaon","Jalna","Kolhapur","Latur","Mumbai City","Mumbai Suburban","Nagpur","Nanded","Nandurbar","Nashik","Osmanabad","Palghar","Parbhani","Pune","Raigad","Ratnagiri","Sangli","Satara","Sindhudurg","Solapur","Thane","Wardha","Washim","Yavatmal"],Manipur:["Bishnupur","Chandel","Churachandpur","Imphal East","Imphal West","Jiribam","Kakching","Kamjong","Kangpokpi","Noney","Pherzawl","Senapati","Tamenglong","Tengnoupal","Thoubal","Ukhrul"],Meghalaya:["East Garo Hills","East Jaintia Hills","East Khasi Hills","Eastern West Khasi Hills","North Garo Hills","Ri Bhoi","South Garo Hills","South West Garo Hills","South West Khasi Hills","West Garo Hills","West Jaintia Hills","West Khasi Hills"],Mizoram:["Aizawl","Champhai","Hnahthial","Khawzawl","Kolasib","Lawngtlai","Lunglei","Mamit","Saiha","Saitual","Serchhip"],Nagaland:["Chumukedima","Dimapur","Kiphire","Kohima","Longleng","Mokokchung","Mon","Niuland","Noklak","Peren","Phek","Shamator","Tseminyu","Tuensang","Wokha","Zunheboto"],Odisha:["Angul","Balangir","Balasore","Bargarh","Bhadrak","Boudh","Cuttack","Deogarh","Dhenkanal","Gajapati","Ganjam","Jagatsinghpur","Jajpur","Jharsuguda","Kalahandi","Kandhamal","Kendrapara","Kendujhar","Khordha","Koraput","Malkangiri","Mayurbhanj","Nabarangpur","Nayagarh","Nuapada","Puri","Rayagada","Sambalpur","Subarnapur","Sundargarh"],Puducherry:["Karaikal","Mahe","Puducherry","Yanam"],Punjab:["Amritsar","Barnala","Bathinda","Faridkot","Fatehgarh Sahib","Fazilka","Ferozepur","Gurdaspur","Hoshiarpur","Jalandhar","Kapurthala","Ludhiana","Malerkotla","Mansa","Moga","Pathankot","Patiala","Rupnagar","Sahibzada Ajit Singh Nagar","Sangrur","Shahid Bhagat Singh Nagar","Sri Muktsar Sahib","Tarn Taran"],Rajasthan:["Ajmer","Alwar","Banswara","Baran","Barmer","Bharatpur","Bhilwara","Bikaner","Bundi","Chittorgarh","Churu","Dausa","Dholpur","Dungarpur","Hanumangarh","Jaipur","Jaisalmer","Jalore","Jhalawar","Jhunjhunu","Jodhpur","Karauli","Kota","Nagaur","Pali","Pratapgarh","Rajsamand","Sawai Madhopur","Sikar","Sirohi","Sri Ganganagar","Tonk","Udaipur"],Sikkim:["East Sikkim","North Sikkim","Pakyong","Soreng","South Sikkim","West Sikkim"],"Tamil Nadu":["Ariyalur","Chengalpattu","Chennai","Coimbatore","Cuddalore","Dharmapuri","Dindigul","Erode","Kallakurichi","Kancheepuram","Kanyakumari","Karur","Krishnagiri","Madurai","Mayiladuthurai","Nagapattinam","Namakkal","Nilgiris","Perambalur","Pudukkottai","Ramanathapuram","Ranipet","Salem","Sivaganga","Tenkasi","Thanjavur","Theni","Thoothukudi","Tiruchirappalli","Tirunelveli","Tirupathur","Tiruppur","Tiruvallur","Tiruvannamalai","Tiruvarur","Vellore","Viluppuram","Virudhunagar"],Telangana:["Adilabad","Bhadradri Kothagudem","Hyderabad","Jagtial","Jangaon","Jayashankar Bhupalpally","Jogulamba Gadwal","Kamareddy","Karimnagar","Khammam","Komaram Bheem","Mahabubabad","Mahbubnagar","Mancherial","Medak","Medchal-Malkajgiri","Mulugu","Nagarkurnool","Nalgonda","Narayanpet","Nirmal","Nizamabad","Peddapalli","Rajanna Sircilla","Rangareddy","Sangareddy","Siddipet","Suryapet","Vikarabad","Wanaparthy","Warangal","Hanamkonda","Yadadri Bhuvanagiri"],Tripura:["Dhalai","Gomati","Khowai","North Tripura","Sepahijala","South Tripura","Unakoti","West Tripura"],"Uttar Pradesh":["Agra","Aligarh","Ambedkar Nagar","Amethi","Amroha","Auraiya","Ayodhya","Azamgarh","Baghpat","Bahraich","Ballia","Balrampur","Banda","Barabanki","Bareilly","Basti","Bhadohi","Bijnor","Budaun","Bulandshahr","Chandauli","Chitrakoot","Deoria","Etah","Etawah","Farrukhabad","Fatehpur","Firozabad","Gautam Buddha Nagar","Ghaziabad","Ghazipur","Gonda","Gorakhpur","Hamirpur","Hapur","Hardoi","Hathras","Jalaun","Jaunpur","Jhansi","Kannauj","Kanpur Dehat","Kanpur Nagar","Kasganj","Kaushambi","Kheri","Kushinagar","Lalitpur","Lucknow","Maharajganj","Mahoba","Mainpuri","Mathura","Mau","Meerut","Mirzapur","Moradabad","Muzaffarnagar","Pilibhit","Pratapgarh","Prayagraj","Raebareli","Rampur","Saharanpur","Sambhal","Sant Kabir Nagar","Shahjahanpur","Shamli","Shravasti","Siddharthnagar","Sitapur","Sonbhadra","Sultanpur","Unnao","Varanasi"],Uttarakhand:["Almora","Bageshwar","Chamoli","Champawat","Dehradun","Haridwar","Nainital","Pauri Garhwal","Pithoragarh","Rudraprayag","Tehri Garhwal","Udham Singh Nagar","Uttarkashi"],"West Bengal":["Alipurduar","Bankura","Birbhum","Cooch Behar","Dakshin Dinajpur","Darjeeling","Hooghly","Howrah","Jalpaiguri","Jhargram","Kalimpong","Kolkata","Malda","Murshidabad","Nadia","North 24 Parganas","Paschim Bardhaman","Paschim Medinipur","Purba Bardhaman","Purba Medinipur","Purulia","South 24 Parganas","Uttar Dinajpur"]},V={title:"Market Price Visualization",description:"Select filters to see price trends for a crop in your market.",selectCommodity:"Select Commodity",selectState:"Select State",selectDistrict:"Select District",enterMarket:"Enter Market Name",fromDate:"From Date",toDate:"To Date",clearFilters:"Clear All Filters",fetchError:"Could Not Fetch Data",noData:"No market data found for this crop/region.",selectFilters:"Please select filters to view price data.",analysisTitle:"Generate Market & Profit Analysis",analysisDescription:"Filter for market data above, then add your costs to get an AI-powered financial summary.",marketDataLabel:"Market Data (per Ton)",marketDataPlaceholder:"This will be auto-filled with data from the chart above. You can also paste your own.",expendituresLabel:"Your Expenditures",expendituresPlaceholder:"e.g., Seeds: ₹2000, Fertilizer: ₹3500, Labor: ₹5000",analyzeButton:"Analyze Now",analyzing:"Generating analysis...",aiAnalysisTitle:"AI-Generated Analysis",marketSummary:"Market Summary",profitLoss:"Profit & Loss Analysis",analysisPlaceholder:"Your market analysis and profit/loss summary will appear here."},_=a=>{let{active:e,payload:r,label:i}=a;if(e&&r&&r.length){let a=r[0].payload;return(0,t.jsx)("div",{className:"rounded-lg border bg-background p-2 shadow-sm",children:(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-1 text-sm",children:[(0,t.jsx)("p",{className:"font-bold",children:a.date?new Date(a.date).toLocaleDateString():"N/A"}),(0,t.jsx)("p",{className:"text-muted-foreground",children:a.variety}),(0,t.jsxs)("div",{className:"mt-2 grid grid-cols-2 gap-x-4 gap-y-1",children:[(0,t.jsx)("span",{className:"font-semibold",children:"Modal:"}),(0,t.jsxs)("span",{children:["₹",a.price]}),(0,t.jsx)("span",{className:"font-semibold",children:"Min:"}),(0,t.jsxs)("span",{children:["₹",a.minPrice]}),(0,t.jsx)("span",{className:"font-semibold",children:"Max:"}),(0,t.jsxs)("span",{children:["₹",a.maxPrice]})]}),(0,t.jsx)("p",{className:"text-xs text-muted-foreground/80 mt-2",children:"Prices are per Ton"})]})})}return null};function I(){let[a,e]=(0,i.useState)(null),[r,l]=(0,i.useState)(!1),{toast:d}=(0,C.dj)(),[p,g]=(0,i.useState)("Wheat"),[x,f]=(0,i.useState)("Punjab"),[H,I]=(0,i.useState)("Amritsar"),[O,Y]=(0,i.useState)(""),[Z,$]=(0,i.useState)(),[q,X]=(0,i.useState)(),[Q,aa]=(0,i.useState)([]),[ae,ar]=(0,i.useState)(!1),[at,ai]=(0,i.useState)(null),[an,as]=(0,i.useState)(!1),{translatedText:al,T:ad,isTranslating:ao}=(0,z.Bd)(V),ah=(0,n.mN)({resolver:(0,s.u)(E),defaultValues:{marketData:"",farmerExpenditures:""}});(0,i.useEffect)(()=>{as(!0);let a=new Date,e=new Date;e.setDate(a.getDate()-30),X(a),$(e)},[]);let au=p||x||H||O||Z||q,am=(0,i.useCallback)(async()=>{if(!au||!Z||!q){aa([]),ai(null);return}ar(!0),ai(null),aa([]);let a=new URLSearchParams;p&&a.append("commodity",p),x&&a.append("state",x),H&&a.append("district",H),O&&a.append("market",O),Z&&a.append("fromDate",(0,h.GP)(Z,"yyyy-MM-dd")),q&&a.append("toDate",(0,h.GP)(q,"yyyy-MM-dd"));try{let e=await fetch("/api/market-data?".concat(a.toString()));if(!e.ok)throw Error("Server temporarily unavailable. Please try again in a few minutes.");let{data:r}=await e.json(),t=r.map(a=>({...a,price:parseFloat(a.price)||0,minPrice:parseFloat(a.minPrice)||0,maxPrice:parseFloat(a.maxPrice)||0,name:a.date?new Date(a.date).toLocaleDateString("en-US",{month:"short",day:"numeric"}):"N/A"})).sort((a,e)=>new Date(a.date).getTime()-new Date(e.date).getTime());if(aa(t),t.length>0){let a="Recent prices for ".concat(p," in ").concat(O||H||x,":\n")+t.map(a=>"- ".concat(a.name,": ₹").concat(a.price,"/ton")).join("\n");ah.setValue("marketData",a)}else ah.setValue("marketData","")}catch(a){console.error("Error fetching chart data:",a),ai(a instanceof TypeError?"Check your internet connection and retry.":"Server temporarily unavailable. Please try again in a few minutes."),aa([])}finally{ar(!1)}},[p,x,H,O,Z,q,ah,au]);async function ac(a){if(!a.marketData)return void d({title:"Missing Data",description:"Please filter for some market data first before generating an analysis.",variant:"destructive"});l(!0),e(null);try{let r=await o(a);e(r)}catch(a){console.error("Error getting market analysis:",a),d({title:"Error",description:"Failed to get market analysis. Please try again.",variant:"destructive"})}finally{l(!1)}}return((0,i.useEffect)(()=>{an&&Z&&q&&am()},[am,Z,q,an]),an)?(0,t.jsxs)("div",{className:"space-y-8",children:[(0,t.jsxs)(v.Zp,{children:[(0,t.jsxs)(v.aR,{children:[(0,t.jsx)(v.ZB,{className:"font-headline",children:(0,t.jsx)(ad,{textKey:"title"})}),(0,t.jsx)(v.BT,{children:(0,t.jsx)(ad,{textKey:"description"})})]}),(0,t.jsxs)(v.Wu,{children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[(0,t.jsxs)(N.l6,{onValueChange:g,value:p,disabled:ao,children:[(0,t.jsx)(N.bq,{children:(0,t.jsx)(N.yv,{placeholder:(0,t.jsx)(ad,{textKey:"selectCommodity"})})}),(0,t.jsx)(N.gC,{children:F.map(a=>(0,t.jsx)(N.eb,{value:a,children:a},a))})]}),(0,t.jsxs)(N.l6,{onValueChange:a=>{f(a),I(""),Y("")},value:x,disabled:ao,children:[(0,t.jsx)(N.bq,{children:(0,t.jsx)(N.yv,{placeholder:(0,t.jsx)(ad,{textKey:"selectState"})})}),(0,t.jsx)(N.gC,{children:W.map(a=>(0,t.jsx)(N.eb,{value:a,children:a},a))})]}),(0,t.jsxs)(N.l6,{onValueChange:a=>{I(a),Y("")},value:H,disabled:!x||ao,children:[(0,t.jsx)(N.bq,{children:(0,t.jsx)(N.yv,{placeholder:(0,t.jsx)(ad,{textKey:"selectDistrict"})})}),(0,t.jsx)(N.gC,{children:x&&U[x]&&U[x].map(a=>(0,t.jsx)(N.eb,{value:a,children:a},a))})]}),(0,t.jsx)(w.p,{placeholder:al.enterMarket,value:O,onChange:a=>Y(a.target.value),disabled:!H&&!x||ao}),(0,t.jsxs)(b,{children:[(0,t.jsx)(S,{asChild:!0,children:(0,t.jsxs)(c.$,{variant:"outline",className:(0,m.cn)("w-full justify-start text-left font-normal lg:col-span-1",!Z&&"text-muted-foreground"),disabled:ao,children:[(0,t.jsx)(u.A,{className:"mr-2 h-4 w-4"}),Z?(0,h.GP)(Z,"yyyy-MM-dd"):(0,t.jsx)("span",{children:(0,t.jsx)(ad,{textKey:"fromDate"})})]})}),(0,t.jsx)(k,{className:"w-auto p-0",children:(0,t.jsx)(y,{mode:"single",selected:Z,onSelect:$,initialFocus:!0})})]}),(0,t.jsxs)(b,{children:[(0,t.jsx)(S,{asChild:!0,children:(0,t.jsxs)(c.$,{variant:"outline",className:(0,m.cn)("w-full justify-start text-left font-normal lg:col-span-1",!q&&"text-muted-foreground"),disabled:ao,children:[(0,t.jsx)(u.A,{className:"mr-2 h-4 w-4"}),q?(0,h.GP)(q,"yyyy-MM-dd"):(0,t.jsx)("span",{children:(0,t.jsx)(ad,{textKey:"toDate"})})]})}),(0,t.jsx)(k,{className:"w-auto p-0",children:(0,t.jsx)(y,{mode:"single",selected:q,onSelect:X,initialFocus:!0})})]}),(0,t.jsx)(c.$,{onClick:function(){g(""),f(""),I(""),Y("");let a=new Date,e=new Date;e.setDate(a.getDate()-30),$(e),X(a)},variant:"outline",className:"lg:col-span-2",disabled:ao,children:(0,t.jsx)(ad,{textKey:"clearFilters"})})]}),(0,t.jsx)("div",{className:"h-[300px]",children:ae?(0,t.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,t.jsx)(D.A,{className:"h-12 w-12 animate-spin text-primary"})}):Q.length>0?(0,t.jsx)(A.u,{width:"100%",height:"100%",children:(0,t.jsxs)(R.E,{data:Q,children:[(0,t.jsx)(T.W,{dataKey:"name",stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1}),(0,t.jsx)(G.h,{stroke:"hsl(var(--muted-foreground))",fontSize:12,tickLine:!1,axisLine:!1,tickFormatter:a=>"₹".concat(a),label:{value:"Price per Ton",angle:-90,position:"insideLeft",style:{textAnchor:"middle",fill:"hsl(var(--muted-foreground))"},offset:-5}}),(0,t.jsx)(J.m,{cursor:{fill:"hsl(var(--accent))",opacity:.3},content:(0,t.jsx)(_,{})}),(0,t.jsx)(L.y,{dataKey:"price",fill:"hsl(var(--primary))",radius:[4,4,0,0]})]})}):(0,t.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-center text-muted-foreground",children:[(0,t.jsx)(M.A,{className:"h-12 w-12 text-muted-foreground/50"}),(0,t.jsx)("p",{className:"mt-4 max-w-xs",children:au?(0,t.jsx)(ad,{textKey:"noData"}):(0,t.jsx)(ad,{textKey:"selectFilters"})})]})})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 items-start",children:[(0,t.jsxs)(v.Zp,{children:[(0,t.jsxs)(v.aR,{children:[(0,t.jsxs)(v.ZB,{className:"font-headline flex items-center gap-2",children:[(0,t.jsx)(B.A,{className:"text-primary"}),(0,t.jsx)(ad,{textKey:"analysisTitle"})]}),(0,t.jsx)(v.BT,{children:(0,t.jsx)(ad,{textKey:"analysisDescription"})})]}),(0,t.jsx)(v.Wu,{children:(0,t.jsx)(j.lV,{...ah,children:(0,t.jsxs)("form",{onSubmit:ah.handleSubmit(ac),className:"space-y-6",children:[(0,t.jsx)(j.zB,{control:ah.control,name:"marketData",render:a=>{let{field:e}=a;return(0,t.jsxs)(j.eI,{children:[(0,t.jsx)(j.lR,{children:(0,t.jsx)(ad,{textKey:"marketDataLabel"})}),(0,t.jsx)(j.MJ,{children:(0,t.jsx)(K.T,{placeholder:al.marketDataPlaceholder,className:"min-h-[120px]",...e})}),(0,t.jsx)(j.C5,{})]})}}),(0,t.jsx)(j.zB,{control:ah.control,name:"farmerExpenditures",render:a=>{let{field:e}=a;return(0,t.jsxs)(j.eI,{children:[(0,t.jsx)(j.lR,{children:(0,t.jsx)(ad,{textKey:"expendituresLabel"})}),(0,t.jsx)(j.MJ,{children:(0,t.jsx)(K.T,{placeholder:al.expendituresPlaceholder,className:"min-h-[80px]",...e})}),(0,t.jsx)(j.C5,{})]})}}),(0,t.jsxs)(c.$,{type:"submit",disabled:r||ao,className:"w-full",children:[r?(0,t.jsx)(D.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,t.jsx)(P.A,{className:"mr-2 h-4 w-4"}),(0,t.jsx)(ad,{textKey:"analyzeButton"})]})]})})})]}),(0,t.jsxs)("div",{className:"lg:sticky top-6",children:[r&&(0,t.jsx)(v.Zp,{children:(0,t.jsxs)(v.Wu,{className:"p-6 flex flex-col items-center justify-center min-h-[300px]",children:[(0,t.jsx)(D.A,{className:"h-12 w-12 animate-spin text-primary"}),(0,t.jsx)("p",{className:"mt-4 text-muted-foreground",children:(0,t.jsx)(ad,{textKey:"analyzing"})})]})}),a&&(0,t.jsxs)(v.Zp,{className:"animate-in fade-in-50",children:[(0,t.jsx)(v.aR,{children:(0,t.jsx)(v.ZB,{className:"font-headline",children:(0,t.jsx)(ad,{textKey:"aiAnalysisTitle"})})}),(0,t.jsxs)(v.Wu,{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-lg font-headline",children:(0,t.jsx)(ad,{textKey:"marketSummary"})}),(0,t.jsx)("p",{className:"text-muted-foreground whitespace-pre-wrap",children:a.summary})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("h3",{className:"font-semibold text-lg font-headline",children:(0,t.jsx)(ad,{textKey:"profitLoss"})}),(0,t.jsx)("p",{className:"text-muted-foreground whitespace-pre-wrap",children:a.profitLossAnalysis})]})]})]}),!r&&!a&&(0,t.jsx)(v.Zp,{className:"border-dashed",children:(0,t.jsxs)(v.Wu,{className:"p-6 flex flex-col items-center justify-center min-h-[300px] text-center",children:[(0,t.jsx)(M.A,{className:"h-12 w-12 text-muted-foreground/50"}),(0,t.jsx)("p",{className:"mt-4 text-muted-foreground",children:(0,t.jsx)(ad,{textKey:"analysisPlaceholder"})})]})})]})]})]}):(0,t.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,t.jsx)(D.A,{className:"h-12 w-12 animate-spin text-primary"})})}},85057:(a,e,r)=>{"use strict";r.d(e,{J:()=>o});var t=r(95155),i=r(12115),n=r(40968),s=r(74466),l=r(59434);let d=(0,s.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=i.forwardRef((a,e)=>{let{className:r,...i}=a;return(0,t.jsx)(n.b,{ref:e,className:(0,l.cn)(d(),r),...i})});o.displayName=n.b.displayName},88539:(a,e,r)=>{"use strict";r.d(e,{T:()=>s});var t=r(95155),i=r(12115),n=r(59434);let s=i.forwardRef((a,e)=>{let{className:r,...i}=a;return(0,t.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:e,...i})});s.displayName="Textarea"}},a=>{var e=e=>a(a.s=e);a.O(0,[66,310,521,861,370,248,660,441,684,358],()=>e(7090)),_N_E=a.O()}]);